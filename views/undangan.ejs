<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Undangan Elektronik</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="/css/style2.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=The+Nautigal:wght@400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lovers+Quarrel&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Murecho:wght@600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Sassy+Frass&family=Ysabeau+SC&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Mr+De+Haviland&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Carme&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Julius+Sans+One&display=swap" rel="stylesheet">
</head>
<body>
  <!-- untuk notifikasi -->
  <div id="notification" class="alert alert-info fixed-notification" style="display: none;    white-space: pre-line;">

  </div>

  <div id="semua_undangan_awal">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="card undangan-card">
                    <div class="card-body text-center">
                        <h2 class="card-title">Undangan Pernikahan</h2>
                        <img src="img/kedua_mempelai.png" alt="Foto Profil" class="img-fluid rounded-circle">
                        <h3 class="mt-3" style="font-family: 'Ysabeau SC', sans-serif;">Fio & Fachri</h3>
                        <p>MInggu 1 Oktober 2023</p>
                        <p>Yth Bpk/Ibu</p>
                        <p style="font-size: 40px;"><%= db_data_kontak.firstName %></p>
                        <p>Kami Sekeluarga Mengundang Anda Ke Acara Pernikahan Kami.</p>
                        <div class="mt-4">
                            <button id="buka" class="btn btn-secondary"  onclick="buka_undangan();"><i class="fa-solid fa-envelope"></i> Buka Undangan</button>
                            <button class="btn btn-secondary" data-toggle="modal" data-target="#undanganModal"><i class="fa-solid fa-qrcode"></i> QrCode</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="undanganModal" tabindex="-1" role="dialog" aria-labelledby="undanganModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div style="position: fixed; bottom: 0%; left: 0%; transition: bottom 0.3s; background-color: rgba(255, 255, 255, 0.2);" class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="undanganModalLabel" style="font-family: sans-serif;">Scan Qr ini</h5>
          </button>
        </div>
        <div class="modal-body">
          <div class="container text-center">
            <div style="max-width: 80%; margin: 0 auto;">
              <img src="<%= qr_undangan %>" alt="QR Code Undangan" style="width: 100%; height: auto;">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- batas untuk buka -->
<div id="untuk_buka" style="display: none; ">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center">
                <!-- Tambahkan kelas "mx-auto" untuk mengatur card di tengah dan "text-center" untuk mengatur teks di tengah -->
                <div class="card undangan-card mx-auto" style="background-image: url('/img/background.jpg'); max-width: 420px;box-shadow: 10px 10px 5px 0px rgba(0,0,0,0.75);
                -webkit-box-shadow: 10px 10px 5px 0px rgba(0,0,0,0.75);
                -moz-box-shadow: 10px 10px 5px 0px rgba(0,0,0,0.75);">
                    <div class="card-body text-center">
                        <img src="img/kedua_mempelai.png" alt="Foto Profil" class="img-fluid rounded-circle">
                        <h3 class="mt-3" style="font-family: 'Ysabeau SC', sans-serif;">Fio & Fachri</h3>
                        <p>MInggu 1 Oktober 2023</p>
                        <p>Yth Bpk/Ibu</p>
                        <p style="font-size: 40px;"><%= db_data_kontak.firstName %></p>
                        <p>Kami Sekeluarga Mengundang Anda Ke Acara Pernikahan Kami.</p>
    
                        <p style="font-size: 20px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;">Hitung Mundur</p>
                        <mark id="hari" style="font-size: 20px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;background: none; color: white;">0</mark>
                        <span style="font-size: 12px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;"> Hari</span>
                        
                        <mark id="jam" style="font-size: 20px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;background: none; color: white;">0</mark>
                        <span style="font-size: 12px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;"> Jam</span>
                        
                        <mark id="menit" style="font-size: 20px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;background: none; color: white;">0</mark>
                        <span style="font-size: 12px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;"> Menit</span>
                        
                        <mark id="detik" style="font-size: 20px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;background: none; color: white;">0</mark>
                        <span style="font-size: 12px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;"> Detik</span>
                        
                        
                        <!-- Akhir elemen undangan -->
                    </div>
                </div>
                <br>
                <div class="card undangan-card mx-auto" style="background-image: url('/img/background.jpg'); max-width: 420px;box-shadow: 10px 10px 5px 0px rgba(0,0,0,0.75);
                -webkit-box-shadow: 10px 10px 5px 0px rgba(0,0,0,0.75);
                -moz-box-shadow: 10px 10px 5px 0px rgba(0,0,0,0.75);">
                    <div class="card-body text-center">

    
                        <p style="font-size: 20px; margin: 0px; font-family: 'Ysabeau SC', sans-serif;">F&F</p>
                        
                        <p>"Dan di antara tanda-tanda (kebesaran)-Nya ialah Dia menciptakan pasangan-pasangan untukmu dari jenismu sendiri, agar kamu cenderung dan merasa tenteram kepadanya, dan Dia menjadikan di antaramu rasa kasih dan sayang"</p>
                        <p>-QS. Ar-Rum: 21-</p>
                        
                        <!-- Akhir elemen undangan -->
                    </div>
                </div>
                <br>
                <div class="card undangan-card mx-auto" style="background:#525a54;">
                    <div class="card-body text-center">
                        <img style="width: 150px;" src="img/bismillah.png" alt="Foto Profil" class="img-fluid rounded-circle">

                        <p style="font-family: sans-serif; font-style: italic;">Assalamualaikum Warahmatullahi Wabarakatuh</p>
                        
                        <p>Maha suci Allah yang telah menciptakan mahluk-Nya berpasang-pasangan. Ya Allah, perkenankanlah kami:</p>
                        <img  src="img/fio.png" alt="Foto Profil" class="img-fluid rounded-circle">
                        <p style="font-family: sans-serif; font-style: italic;">Fio Rentina Azzahra S.H</p>
                        <p>Putri Ke 1 Bapak Suwarno & Ibu Sumiyati</p>
                        <p>(Toko Buku Subur Makmur)</p>
                        <img style="width: 150px;" src="img/dan.png" alt="Foto Profil" class="img">
                        <!-- dan -->
                        <img  src="img/fachri.png" alt="Foto Profil" class="img-fluid rounded-circle">
                        <p style="font-family: sans-serif; font-style: italic;">Muhammad Fachri Baharsyah S.T</p>
                        <p>Putra Ke 1 Bapak Kasino & Ibu Dwi Setyowati</p>
                        <p>(Toko Regulator)</p>
                        <!-- Akhir elemen undangan -->
                    </div>
                </div>
                <br>
                <div class="card undangan-card mx-auto" style="background:#525a54;">
                    <div class="card-body text-center">
                        <img style="width: 150px;" src="img/bismillah.png" alt="Foto Profil" class="img-fluid rounded-circle">

                        <p style="font-family: sans-serif; font-style: italic;">Dengan Memohon Rahmat Dan Ridho Allah Subhanahu Wa Ta'ala, Kami Mengundang Bapak/Ibu <%= db_data_kontak.firstName %>, Untuk Menghadiri Resepsi Pernikahan Kami. Yang Insya Allah Akan Dilaksanakan Pada :</p>
                        
                        <img  src="img/gambar_akad.png" alt="Foto akad" class="img-fluid">
                        <img style="width: 150px;" src="img/dan.png" alt="Foto Profil" class="img-fluid">
                        <!-- dan -->
                        <img  src="img/gambar_resepsi.png" alt="Foto Resepsi" class="img-fluid">
                        <div class="mt-4">
                            <button class="btn btn-secondary"  onclick="buka_maps();"><i class="fa-solid fa-location-dot"></i> Lokasi</button>
                        </div>
                        <!-- Akhir elemen undangan -->
                    </div>
                </div>
                <br>
                <div class="card undangan-card mx-auto" style="background:#525a54;">
                    <div class="card-body text-center">
                        <p style="text-align: left;">Turut Mengundang:</p>
                        <p style="text-align: left;"> Bpk Ahmad Supandi</span> (Sesepuh)</p>
                        <p style="text-align: left;"> Ust Hanifah</span> (Guru)</p>
                        <p style="text-align: left;"> Bpk Andi Kusmana,S.H</span> (Ketua Rw 032)</p>
                        <p style="text-align: left;"> Bpk Suryanto,S.E</span> (Ketua Rw 039)</p>
                        <p style="text-align: left;"> Bpk Achmad Rifai </span> (Ketua Rt 01 Rw 039)</p>
                        <p style="text-align: left;"> Bpk Nur Rochmat </span> (Ketua Rt 03 Rw 032)</p>
                        <p style="text-align: left;"> Ust.Syafiq Abrori,S.P,M.M </span> (Guru PIT Bogor)</p>
                        <p style="text-align: left;"> Ibu Farida</span> (Ketua Rt 05 Rw 004)</p>
                        <!-- Akhir elemen undangan -->
                    </div>
                </div>
                <br>
                <div class="card undangan-card mx-auto" style="background:#525a54;">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card text-white">
                                <div class="card-body" style="background:#525a54;">
                                    <h5 class="card-title">Hadir : <%= db_data_jumlah_hadir %></h5>
                                    <button id="hadir" class="btn btn-light" onclick="konfirmasi('hadir')">Konfirmasi</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card text-white">
                                <div class="card-body" style="background:#525a54;">
                                    <h5 class="card-title">Tidak Hadir : <%= db_data_jumlah_tidak_hadir %></h5>
                                    <button id="tidak_hadir" class="btn btn-light" onclick="konfirmasi('tidak_hadir')">Konfirmasi</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <br>
                <div class="card undangan-card mx-auto" style="background:#525a54;">
                    <div class="card-body text-center" style="overflow-x: scroll; height: 300px;">
                        <ul class="list-group" style="color: white;">
                            <li class="list-group-item" style=" border: none; background: none; color: white;">
                                <i class="fa-regular fa-comment"></i>&nbsp;Berikan Ucapan
                            </li>
                            <div id="id_nya"></div>
                            <% db_data_komentar.forEach(kirim_komentar => { %>
                                <li class="list-group-item" id="<%= kirim_komentar._id %>" style="background: none; text-align: left; border: none;">
                                    <i class="fa-regular fa-comments"></i>&nbsp;<%= kirim_komentar.nama_akun %>
                                    <br>
                                    <span style="color: white;">
                                        <i class="fa-solid fa-clock"></i>&nbsp;<span class="tanggal"><%=kirim_komentar.tanggal%></span>
                                    </span>
                                    <br>
                                    <span style="color:white; white-space: pre-line;">
                                        <%= kirim_komentar.komentar %>
                                      </span>
                                      
                                </li>
                            <% }); %>
                        </ul>
                        

                    </div>
                </div>
            </div>
        </div>
    </div>
    
  
    <div class="col-md-6" style="position: relative; top: 0px;">
      <div class="input-group">
        <textarea style="width: 80%; border: none; font-family: 'Ysabeau SC', sans-serif;box-shadow: 10px 10px 31px -12px rgba(0,0,0,0.75);
        -webkit-box-shadow: 10px 10px 31px -12px rgba(0,0,0,0.75);
        -moz-box-shadow: 10px 10px 31px -12px rgba(0,0,0,0.75);" id="komentar" placeholder="Berikan Ucapan" rows="2"></textarea>
        <div class="input-group-append">
          <button type="button" style="background:#525a54; border: none; color: white;box-shadow: 10px 10px 31px -12px rgba(0,0,0,0.75);
          -webkit-box-shadow: 10px 10px 31px -12px rgba(0,0,0,0.75);
          -moz-box-shadow: 10px 10px 31px -12px rgba(0,0,0,0.75);" onclick="komentar()">Kirim</button>
        </div>
      </div>
    </div>
    <svg id="ombak_kotak_terimakasih" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#ffffff" fill-opacity="1" d="M0,64L48,106.7C96,149,192,235,288,224C384,213,480,107,576,58.7C672,11,768,21,864,58.7C960,96,1056,160,1152,181.3C1248,203,1344,181,1392,170.7L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>
      <div id="kotak_terimakasih" style="  background: white">
        <img style="width: 250px;" src="/img/fiodanfachri.png" alt="">
    </div>
  
    
      <audio id="backgroundMusic" loop autoplay>
        <source src="audio/murotal.mp3" type="audio/mpeg" autoplay="true"
        muted="muted">
        Your browser does not support the audio element.
    </audio>
    
    <i id="playButton" class="fa-solid fa-volume-high"></i>
  </div>


  </center>
<script>

// untuk  lokasi
function buka_maps() {
    window.location.href = "https://goo.gl/maps/o1eqx5DKfWgs4M2p9"; 
}


window.onload = function() {
        const elementsWithClass = document.getElementsByClassName('tanggal');
const count = elementsWithClass.length;
console.log(count);

for (var i = 0; i < count; i++) {
  var tanggal = elementsWithClass[i].textContent; // Menggunakan elementsWithClass[i]
  const referenceDateString = tanggal;
  const referenceDate = new Date(referenceDateString);

  const currentDate = new Date();

  const timeDifference = currentDate - referenceDate;

  const minutes = Math.floor(timeDifference / (1000 * 60));
  const hours = Math.floor(timeDifference / (1000 * 60 * 60));
  const days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
  const months = Math.floor(timeDifference / (1000 * 60 * 60 * 24 * 30.44));
  const years = Math.floor(timeDifference / (1000 * 60 * 60 * 24 * 365.25));

  const resultElement = elementsWithClass[i]; // Menggunakan elementsWithClass[i]

  if (years > 0) {
    resultElement.textContent = `${years} tahun yang lalu`;
  } else if (months > 0) {
    resultElement.textContent = `${months} bulan yang lalu`;
  } else if (days > 0) {
    resultElement.textContent = `${days} hari yang lalu`;
  } else if (hours > 0) {
    resultElement.textContent = `${hours} jam yang lalu`;
  } else {
    resultElement.textContent = `${minutes} menit yang lalu`;
  }
}

}
// batansya ----------------------------------------------------------


  function komentar() {
    const komentar= document.getElementById(`komentar`);
        const notificationCard = document.getElementById('notification');
        const showNotificationBtn = document.getElementById('showNotification');
        const waktu = new Date();
        const options = { year: 'numeric', month: 'numeric', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric' };
        const formattedTime = waktu.toLocaleDateString('en-US', options);
            console.log(formattedTime);


        // Objek data yang akan dikirimkan
        const data = {
          komentar:komentar.value,
          nama:"<%= db_data_kontak.firstName %>",
          waktu:formattedTime
        };
    
        fetch(`/undangan/komentar`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(() => {

              // Tampilkan data yang diperbarui di halaman
    const updateResultElement = document.getElementById('id_nya');
    updateResultElement.innerHTML = `
    <li class="list-group-item" id="2144234234234234" style="background: none; text-align: left;">
                                    <i class="fa-regular fa-comments"></i>&nbsp;<%= db_data_kontak.firstName %>
                                    <br>
                                    <span style="color: white;">
                                        <i class="fa-solid fa-clock"></i>&nbsp;<span class="tanggal">0 menit yang lalu</span>
                                    </span>
                                    <br>
                                    <span style="color: white;">
                                        ${komentar.value}
                                    </span>
                                </li>`;


      komentar.value="";
      notificationCard.innerHTML="Berhasil Memberikan Ucapan";

      notificationCard.style.display = 'block';

      notificationCard.classList.add('show-notification');

      setTimeout(() => {
        notificationCard.classList.remove('show-notification');


        setTimeout(() => {
          notificationCard.style.display = 'none';
        }, 500); 
      }, 2000);
    })
        .catch(error => {
          console.error('Terjadi kesalahan:', error);
        });
      }


// untuk hitung mundur-------------------
const currentTime = new Date().toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });

const targetTime = new Date('2023-10-21T09:00:00').toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });

const timeDifference = new Date(targetTime) - new Date(currentTime);

const secondsDifference = Math.floor(timeDifference / 1000);


  var seconds = secondsDifference;
  
  function countdown() {
    var days = Math.floor(seconds / 24 / 60 / 60);
    var hoursLeft = Math.floor((seconds) - (days * 86400));
    var hours = Math.floor(hoursLeft / 3600);
    var minutesLeft = Math.floor((hoursLeft) - (hours * 3600));
    var minutes = Math.floor(minutesLeft / 60);
    var remainingSeconds = seconds % 60;
    
    document.getElementById("hari").innerHTML = days;
    document.getElementById("jam").innerHTML = hours;
    document.getElementById("menit").innerHTML = minutes;
    document.getElementById("detik").innerHTML = remainingSeconds;
    
    if (seconds > 0) {
      seconds--;
    } else {
      clearInterval(countdownInterval);
    }
  }
  
  var countdownInterval = setInterval(countdown, 1000);

  function buka_undangan() {
    document.getElementById('semua_undangan_awal').style.display = 'none';
    document.getElementById('untuk_buka').style.display = "block";

    // Mengakses elemen body
    var body = document.body;

    // Menghapus gambar latar belakang (background image)
    body.style.backgroundImage = "none";

    // Mengatur warna latar belakang (background color) menjadi merah
    body.style.backgroundColor = "white"; // Ganti dengan warna yang diinginkan
}


    // untuk audio 
    const backgroundMusic = document.getElementById('backgroundMusic');
    const buka = document.getElementById('buka');

        const playButton = document.getElementById('playButton');

        // Fungsi untuk mengubah label tombol dan mengontrol pemutaran musik
        function toggleMusic() {
            if (backgroundMusic.paused) {
    backgroundMusic.play();
    playButton.classList.remove('fa-volume-mute');
    playButton.classList.add('fa-volume-up');
} else {
    backgroundMusic.pause();
    playButton.classList.remove('fa-volume-up');
    playButton.classList.add('fa-volume-mute');
}

        }

        // Panggil toggleMusic saat tombol diklik
        playButton.addEventListener('click', toggleMusic);
        buka.addEventListener('click', toggleMusic);


        // Panggil toggleMusic saat halaman dimuat (untuk memutar musik secara otomatis)


        // konfirmasi 

        function konfirmasi(isi){
            const notificationCard = document.getElementById('notification');
        const showNotificationBtn = document.getElementById('showNotification');
        const hadir = document.getElementById('hadir');
        const tidak_hadir = document.getElementById('tidak_hadir');


        // Objek data yang akan dikirimkan
        const data_konfirmasi = {
          konfirmasi:isi,
          nama:"<%= db_data_kontak.firstName %>"
        };
    
        fetch(`/konfirmasi_kehadiran`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data_konfirmasi)
        })
        .then(response => response.json())
        .then(data_konfirmasi => {


      notificationCard.innerHTML="Berhasil Konfirmasi";

      notificationCard.style.display = 'block';
      hadir.style.display='none';
      tidak_hadir.style.display='none';



      notificationCard.classList.add('show-notification');

      setTimeout(() => {
        notificationCard.classList.remove('show-notification');


        setTimeout(() => {
          notificationCard.style.display = 'none';
        }, 500); 
      }, 2000);
    })
        .catch(error => {
          console.error('Terjadi kesalahan:', error);
        });
        }
  </script>
  <script src="https://kit.fontawesome.com/3d5b751cd6.js" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="/js/index.js"></script>
</body>
</html>
